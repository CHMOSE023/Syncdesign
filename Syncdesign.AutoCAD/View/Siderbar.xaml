<UserControl x:Class="Syncdesign.AutoCAD.View.Siderbar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:Syncdesign.AutoCAD.View"
             xmlns:vm="clr-namespace:Syncdesign.AutoCAD.ViewModel"
             xmlns:bim="http://bimhub.top/syncdesign/2026/xaml"
             Height="auto" Width="auto">
    
    <!-- 绑定 ViewModel -->
    <UserControl.DataContext>
        <vm:SidebarViewModel/>
    </UserControl.DataContext>
    
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <bim:ControlsDictionary/>
                <bim:ThemesDictionary/>
            </ResourceDictionary.MergedDictionaries>
            <!-- Sidebar Button 样式 -->
            <Style x:Key="SidebarButtonStyle" TargetType="Button">
                <Setter Property="Height" Value="42"/>
                <Setter Property="Width" Value="42"/>                 
                <Setter Property="Background" Value="Transparent"/>               
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="Foreground" Value="Black"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="Button">
                            <Border x:Name="Bd"  Margin="3"  CornerRadius="4"  BorderThickness="0"  Background="{TemplateBinding Background}">
                                <ContentPresenter   HorizontalAlignment="Center"      VerticalAlignment="Center"/>
                            </Border>
                            <ControlTemplate.Triggers>
                                <!-- Hover -->
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Bd" Property="Background"   Value="LightGray"/>
                                </Trigger>
                                <!-- Pressed（仍然是圆角） -->
                                <Trigger Property="IsPressed" Value="True">
                                    <Setter TargetName="Bd" Property="Background" Value="#D0D0D0"/>
                                    <Setter Property="Foreground" Value="Gray"/>
                                </Trigger>
                                <!-- Selected -->
                                <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                    <Setter Property="Foreground" Value="#2E4053"/>
                                    <Setter TargetName="Bd" Property="Background"   Value="#29000000"/>
                                </DataTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
       
    </UserControl.Resources>
    <Grid >
        <Grid.RowDefinitions>
            <!-- 顶部菜单 -->
            <RowDefinition Height="Auto"/>
            <!-- 中间占满剩余空间 -->
            <RowDefinition Height="*"/>
            <!-- 底部设置 -->
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 顶部菜单（消息 / 联系人 / 项目 / 任务 / 审查 / 流程） -->
        <ItemsControl Grid.Row="0"  ItemsSource="{Binding TopItems}">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <StackPanel/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>

            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Button Command="{Binding Command}" Style="{StaticResource SidebarButtonStyle}" ToolTip="{Binding Title}">
                        <StackPanel>
                            <bim:SymbolIcon FontSize="20"   Symbol="{Binding Symbol}"/>
                            <Label Content="{Binding Title}" 
                                   Padding="0" 
                                   FontSize="11"
                                   Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>
                        </StackPanel>
                    </Button>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <!-- 中间空白，占满剩余高度（关键） -->
        <Border Grid.Row="1" Background="Transparent"/>

        <!-- 底部设置 -->
        <ItemsControl Grid.Row="2"   ItemsSource="{Binding BottomItems}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>   
                    <!--悬浮绑定 Title-->
                    <Button  Command="{Binding Command}"  Style="{StaticResource SidebarButtonStyle}">
                        <StackPanel >
                            <bim:SymbolIcon FontSize="20"   Symbol="{Binding Symbol}"  />
                            <Label Content="{Binding Title}"
                                   FontSize="11" 
                                   Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" 
                                   Padding="0" />
                        </StackPanel>
                    </Button>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Grid>
</UserControl>
